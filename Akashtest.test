
# Print a test page using create-job + send-document
{
	# The name of the test...
	NAME "Print test page using create-job"

	# The resource to use for the POST
	# RESOURCE /admin

	# The operation to use
	OPERATION create-job

	# Attributes, starting in the operation group...
	GROUP operation
	ATTR charset attributes-charset utf-8
	ATTR language attributes-natural-language en
	ATTR uri printer-uri $uri
	ATTR name requesting-user-name $user

	GROUP job
	ATTR integer copies 1
	ATTR keyword output-bin "face-down"

	# What statuses are OK?
	STATUS successful-ok

	DISPLAY job-uri

	# What attributes do we expect?
	EXPECT job-id
	EXPECT job-uri
}
{
	# The name of the test...
	NAME "... and send-document"

	# The resource to use for the POST
	# RESOURCE /admin

	# The operation to use
	OPERATION send-document

	# Attributes, starting in the operation group...
	GROUP operation
	ATTR charset attributes-charset utf-8
	ATTR language attributes-natural-language en
	ATTR uri printer-uri $uri
	ATTR integer job-id $job-id
	ATTR name requesting-user-name $user
	ATTR boolean last-document true

	#FILE ../data/testprint.ps
	FILE ./document-a4.pdf

	# What statuses are OK?
	STATUS successful-ok
}


# Test get-job-attributes by sending a print job, getting the attributes,
# and cancelling it.
{
	# The name of the test...
	NAME "Get job info with get-job-attributes"

	# The resource to use for the POST
	# RESOURCE /admin

	# The operation to use
	OPERATION get-job-attributes

	# Attributes, starting in the operation group...
	GROUP operation
	ATTR charset attributes-charset utf-8
	ATTR language attributes-natural-language en
	ATTR uri job-uri $job-uri
	ATTR keyword requested-attributes output-bin,copies, job-media-sheets-completed,job-state

	DISPLAY job-state
	DISPLAY copies
	DISPLAY output-bin
	DISPLAY job-media-sheets-completed

	# What statuses are OK?
	#STATUS successful-ok
	#STATUS successful-ok-ignored-or-substituted-attributes

	# What attributes do we expect?
	#EXPECT job-uri
	EXPECT job-state
	EXPECT output-bin WITH-VALUE "face-down"
}
